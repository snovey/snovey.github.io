<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<!--link href="//blog.snovey.com/css/main.css?v=1.0.0" rel="stylesheet" type="text/css" /-->


  <meta name="keywords" content="undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined," />







  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.0.0" />



  <link rel="canonical" href="www.snovey.com/2016/06/toposort/"/>

<title>雨雪霏霏</title>
<link rel="stylesheet" href="/css/style.css">

</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN" class="typo">
  <header class="header">
  <div class="header-inner">
    <div class="blog-title">
      <a href="/" class="logo">雨雪霏霏</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          <li class="menu-item">
            <a href="/" class="menu-item-link">首页</a>
          </li>
          
          <li class="menu-item">
            <a href="/archives" class="menu-item-link">归档</a>
          </li>
          
          <li class="menu-item">
            <a href="/categories" class="menu-item-link">分类</a>
          </li>
          
          <li class="menu-item">
            <a href="/tags" class="menu-item-link">标签</a>
          </li>
          
          <li class="menu-item">
            <a href="/about" class="menu-item-link">关于</a>
          </li>
          
        </ul>
      </nav>
  </div>
</header>

  <main class="main">
    <aside class="siderbar">
  <section class="siderbar-panel">
    <div class="author-panel" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <img class="author-image" itemprop="image" src="//blog.snovey.com/uploads/avatar.jpg" alt="雨雪霏霏">
      <p class="author-name" itemprop="name">雨雪霏霏</p>
      <p class="site-description" itemprop="description" >简单快乐与幸福同行</p>
    </div>
    <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="">
          <span class="site-state-item-name">日志</span>
          <span class="site-state-item-count">11</span>
        </a>
      </div>
      
        <div class="site-state-item site-state-categories">
          <a href="">
            <span class="site-state-item-name">分类</span>
            <span class="site-state-item-count">4</span>
          </a>
        </div>
      
      
        <div class="site-state-item site-state-tags">
          <a href="">
            <span class="site-state-item-name">标签</span>
            <span class="site-state-item-count">11</span>
          </a>
        </div>
      
    </nav>
    <div class="feed-link motion-element" style="opacity: 1; display: block; transform: translateX(0px);">
      <a href="/atom.xml" rel="alternate">RSS</a>
    </div>
    <div class="links-of-author motion-element">
    </div>
    <div class="cc-license motion-element" itemprop="license">
      <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">
        <img src="//blog.snovey.com/images/cc-by-nc-nd.svg" alt="Creative Commons">
      </a>
    </div>
  </section>
</aside>
    <button type="button" id="info"><?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1502186391435" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1007" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><defs><style type="text/css"></style></defs><path d="M65.012178 128.544655 65.012178 230.875275 959.381795 230.875275 959.381795 128.544655 65.012178 128.544655Z" p-id="1008" fill="#ffffff"></path><path d="M64.729745 563.201126 959.269231 563.201126 959.269231 460.870506 64.729745 460.870506 64.729745 563.201126Z" p-id="1009" fill="#ffffff"></path><path d="M64.729745 895.525953 959.269231 895.525953 959.269231 793.195334 64.729745 793.195334 64.729745 895.525953Z" p-id="1010" fill="#ffffff"></path><path d="M64.729745 889.742227" p-id="1011" fill="#000000"></path></svg></button>
    <article class="post">
  <div class="post-title">
    <h2 class="title">拓扑排序的算法实现</h2>
  </div>
   <div class="post-meta">
    <span class="post-time">2016-06-06</span>
  </div>
  <div class="post-content">
    <p>对于一个有向图，可以通过拓扑排序（Topological Sort）来判断是否是有向无环图（Directed Acyclic Graph，DAG）。<br>拓扑排序的算法思想是：</p>
<ol>
<li>每次从图中取出入度为 0 的节点</li>
<li>删除该节点发出的所有边，进行（1）步骤</li>
</ol>
<a id="more"></a>
<p>邻接表的实现方式如下：<br><img src="//blog.snovey.com/image/toposort.png" alt="toposort"><br>初始的时候建立两个表，一个邻接表，以及另外一个表存储出度为0的节点，每次将入度表中入度为 0 的点加入容器中，然后从容器中取出节点，去邻接表中查询，根据邻接表修改入度表，发现入度为 0 的点加入容器中，如此反复，直至容器为空。<br>如果最终入度表中有入度不为 0 的节点，则该图有环，否则该图无环。若该图为偏序关系，则某一时刻容器中的元素多于一个，取出的元素可能是随机的，造成拓扑排序的结果不唯一，与容器的选取有关。若该图为全序关系，则容器中的元素始终只有一个，结果唯一，与容器的选取无关。<br>下面以题为例说明：<br>HDU 3342<br>题意：有一个 ACM 日常 QQ 交流群，群内存在一些师徒关系，若存在某个人的徒弟是自己的师傅的情况则不合法，输出 NO，否则输出 YES。此题有 trick，即要判断重边，代码如下<br><figure class="highlight c++"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> n, m, x, y, cnt, table[<span class="number">105</span>];</div><div class="line">    <span class="keyword">bool</span> vis[<span class="number">105</span>][<span class="number">105</span>];  <span class="comment">//防止出现重边</span></div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m) &amp;&amp; n &amp;&amp; m)</div><div class="line">    &#123;</div><div class="line">        cnt = <span class="number">0</span>;</div><div class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</div><div class="line">        <span class="built_in">memset</span>(table, <span class="number">0</span>, <span class="keyword">sizeof</span>(table));</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v[<span class="number">105</span>];  <span class="comment">//邻接表</span></div><div class="line">        <span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; st;  <span class="comment">//存储入度为0的节点</span></div><div class="line">        <span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;::iterator it;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">            <span class="keyword">if</span>(!vis[x][y])</div><div class="line">            &#123;</div><div class="line">                v[x].push_back(y);</div><div class="line">                table[y]++;</div><div class="line">                vis[x][y] = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="keyword">if</span>(table[i] == <span class="number">0</span>)</div><div class="line">                cnt++, st.insert(i);</div><div class="line">        <span class="keyword">while</span>(!st.empty())</div><div class="line">        &#123;</div><div class="line">            it = st.begin();</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v[*it].size(); i++)</div><div class="line">            &#123;</div><div class="line">                table[v[*it][i]]--;</div><div class="line">                <span class="keyword">if</span>(table[v[*it][i]] == <span class="number">0</span>)</div><div class="line">                    cnt++, st.insert(v[*it][i]);</div><div class="line">            &#125;</div><div class="line">            st.erase(*it);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(cnt == n ? <span class="string">"YES\n"</span> : <span class="string">"NO\n"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>版权声明<br><hr>本作品采用<a rel="external" href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可。<br>本文链接：www.snovey.com/2016/06/toposort/</blockquote>
  </div>
</article>


  </main>
  <footer class="footer">
  <div class="footer-inner">
    <p class="copyright">
      雨雪霏霏 &copy; 2016-2017
    </p>
    <p class="info">
      Power by hexo &#124; Theme delica &#124; Host on GitHub, Coding
    </p>
  </div>
</footer>

  <script>
    function toggleClassMenu() {
      myMenu.classList.add("siderbar--animatable");
    if(!myMenu.classList.contains("siderbar--visible")) {
      myMenu.classList.add("siderbar--visible");
    } else {
      myMenu.classList.remove('siderbar--visible');
    }
    }

    function OnTransitionEnd() {
      myMenu.classList.remove("siderbar--animatable");
    }

    var myMenu = document.querySelector(".siderbar");
    var oppMenu = document.querySelector("#info");
    myMenu.addEventListener("transitionend", OnTransitionEnd, false);
    oppMenu.addEventListener("click", toggleClassMenu, false);
    myMenu.addEventListener("click", toggleClassMenu, false);
  </script>
</body>
</html>
